<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhishun.zaotoutiao.dal.mapper.ChannelsMapper" >
  <resultMap id="BaseResultMap" type="com.zhishun.zaotoutiao.core.model.entity.Channels" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
      <id column="id" property="id" jdbcType="BIGINT" />
      <result column="channelId" property="channelId" jdbcType="VARCHAR" />
      <result column="name" property="name" jdbcType="VARCHAR" />
      <result column="channelOrder" property="channelOrder" jdbcType="INTEGER" />
      <result column="channelType" property="channelType" jdbcType="INTEGER" />
      <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
      <result column="update_date" property="updateDate" jdbcType="TIMESTAMP" />
      <result column="status" property="status" jdbcType="INTEGER" />
      <result column="appType" property="appType" jdbcType="INTEGER" />
      <result column="parentId" property="parentId" jdbcType="BIGINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, channelId, name, channelOrder, channelType, create_date, update_date, status, appType, parentId
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from channels
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from channels
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.zhishun.zaotoutiao.core.model.entity.Channels" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into channels (id, channelId, name, 
      channelOrder, channelType, create_date, update_time, status , appType, parentId
      )
    values (#{id,jdbcType=BIGINT}, #{channelId,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR},
      #{channelOrder,jdbcType=INTEGER}, #{channelType,jdbcType=INTEGER}, #{createDate,jdbcType=TIMESTAMP},
      #{updateDate,jdbcType=TIMESTAMP}, #{status,jdbcType=INTEGER}, #{appType,jdbcType=INTEGER}, #{parentId,jdbcType=BIGINT}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.zhishun.zaotoutiao.core.model.entity.Channels" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into channels
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="channelId != null" >
        channelId,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="channelOrder != null" >
        channelOrder,
      </if>
      <if test="channelType != null" >
        channelType,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="updateDate != null" >
        update_date,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="appType != null" >
        appType,
      </if>
      <if test="parentId != null" >
        parentId
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="channelId != null" >
        #{channelId,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="channelOrder != null" >
        #{channelOrder,jdbcType=INTEGER},
      </if>
      <if test="channelType != null" >
        #{channelType,jdbcType=INTEGER},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateDate != null" >
        #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="appType != null" >
        #{appType,jdbcType=INTEGER},
      </if>
      <if test="parentId != null" >
        #{parentId,jdbcType=BIGINT}
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zhishun.zaotoutiao.core.model.entity.Channels" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update channels
    <set >
      <if test="channelId != null" >
        channelId = #{channelId,jdbcType=VARCHAR},
      </if>
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="channelOrder != null" >
        channelOrder = #{channelOrder,jdbcType=INTEGER},
      </if>
      <if test="channelType != null" >
        channelType = #{channelType,jdbcType=INTEGER},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="appType != null" >
        appType = #{appType,jdbcType=INTEGER},
      </if>
      <if test="parentId != null" >
        parentId = #{parentId,jdbcType=BIGINT}
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zhishun.zaotoutiao.core.model.entity.Channels" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update channels
    set channelId = #{channelId,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      channelOrder = #{channelOrder,jdbcType=INTEGER},
      channelType = #{channelType,jdbcType=INTEGER},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      update_date = #{updateDate,jdbcType=TIMESTAMP},
      status = #{status,jdbcType=INTEGER}
      appType = #{appType,jdbcType=INTEGER}
      parentId = #{parentId,jdbcType=BIGINT}
    where id = #{id,jdbcType=BIGINT}
  </update>

  <select id="listChannelsPage" resultMap="BaseResultMap" parameterType="map" >
    select
    <include refid="Base_Column_List" />
    from channels
    <where>
      <if test="name != null">
        name LIKE CONCAT('%', #{name}, '%')
      </if>
      <if test="status != null">
        and status = #{status}
      </if>
    </where>
  </select>

  <select id="countChannels" resultType="int" parameterType="map">
    SELECT
    count(id)
    FROM channels
    <where>
      <if test="name != null">
        name LIKE CONCAT('%', #{name}, '%')
      </if>
      <if test="status != null">
        and status = #{status}
      </if>
    </where>
  </select>

  <select id="listChannels" resultMap="BaseResultMap">
    SELECT
    <include refid="Base_Column_List" />
    FROM channels
    WHERE parent = 0
    order By channelOrder ASC
  </select>

  <select id="getChannelsList" parameterType="map" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    from channels
    <where>
      parentId = #{parentId}
      <if test="name !=null">
      and  name LIKE CONCAT('%', #{name}, '%')
      </if>
      <if test="status !=null">
      and  status = #{status}
      </if>
      <if test="appType !=null">
      and  appType = #{appType}
      </if>
    </where>
    order by channelOrder asc
  </select>

  <select id="getSmallerOrder" parameterType="int" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM channels
    where channelOrder &lt; #{oldOrderNum}
    order by channelOrder desc
    limit 1;
  </select>

  <select id="getBiggerOrder" parameterType="int" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM channels
    where channelOrder &gt; #{oldOrderNum}
    order by channelOrder asc
    limit 1;
  </select>

  <select id="getMaxOrder" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    order by channelOrder DESC
    limit 1;
  </select>

  <select id="getTabList" resultMap="BaseResultMap" parameterType="map">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    <where>
      parentId != 0
      <if test="name !=null">
        and name LIKE CONCAT('%', #{name}, '%')
      </if>
      <if test="parentId !=null">
        and parentId = #{parentId}
      </if>
      <if test="appType !=null">
        and appType = #{appType}
      </if>
    </where>
    order by channelOrder asc
  </select>

  <select id="getChannelsByChannelId" parameterType="string" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    WHERE channelId = #{channelId}

  </select>

  <select id="listVideoChannels" parameterType="map" resultMap="BaseResultMap">
    SELECT
    <include refid="Base_Column_List" />
    FROM channels
    <where>
      <if test="status != null">
        status = #{status}
      </if>
      <if test="appType != null">
        and appType = #{appType}
      </if>
    </where>
  </select>

  <select id="channelListByInfoType" parameterType="Integer" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    WHERE appType = #{appType}
    and parentId = 0
  </select>

  <select id="getChildTabList" parameterType="Long" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    where parentId = #{parentId}
  </select>

  <select id="getFirstTabListByParentIdAndInfoType" parameterType="map" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    WHERE appType = #{appType}
    <choose>
      <when test="parentId != null">
        AND parentId = #{parentId}
      </when>
      <otherwise>
        AND parentId in(select id from channels where parentId = 0)
      </otherwise>
    </choose>
  </select>

  <select id="getSecondTabListByParentIdAndInfoType" parameterType="map" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List" />
    FROM channels
    WHERE appType = #{appType}
    <choose>
      <when test="parentId != null">
        AND parentId = #{parentId}
      </when>
      <otherwise>
        AND parentId in(select id from channels where parentId in(select id from channels where parentId = 0))
      </otherwise>
    </choose>
  </select>

  <select id="getAppTypeList" resultType="java.lang.Integer">
    SELECT appType
    FROM channels
    GROUP by appType
  </select>


</mapper>