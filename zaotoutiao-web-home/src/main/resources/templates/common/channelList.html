<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>table模块快速使用</title>
    <link rel="stylesheet" href="../../static/layui/css/layui.css" media="all">
</head>
<body>
<div class="demoTable">
    <div class="layui-inline">
        <input class="layui-input" name="name" id="name" placeholder="关键词" autocomplete="off">
    </div>
    <div class="layui-inline">
        <select name="status" id="status">
            <option value="">状态</option>
            <option value="1">激活</option>
            <option value="0">未激活</option>
        </select>
    </div>
    <button class="layui-btn" data-type="reload">搜索</button>
</div>
<table class="layui-hide" id="channel_table_id"></table>
<div id="laypage"></div>
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del"><i class="layui-icon"></i>删除</a>
</script>

<script src="../../static/layui/layui.js"></script>
<script src="../../static/js/jquery-3.3.1.js" ></script>
<script>
    //列表查询方法
    function channelSearch(name, status) {
        layui.use('table', function(){
            var table = layui.table;
            table.render({
                elem: '#channel_table_id',
                url: 'channel/list',
                where:{name:name,status:status},  //传参
                cols: [[
                    {field: 'id', title: '序号', width: '170', sort: true},
                    {field: 'name', title: '导航', width: '250'},
                    {field: 'status', title: '状态', width: '100'},
                    {field: 'updateDate', title: '操作日期', width: '120', sort: true},
                    {field: 'right', title: '操作', width: '200',fixed: 'right', toolbar: '#barDemo'}
                ]],
                page: false,
                height: 430,
                done: function(res, curr, count){
                    //如果是异步请求数据方式，res即为你接口返回的信息。
                    //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
                    laypage.render({
                        elem:'laypage',
                        count:count,
                        layout: ['count', 'prev', 'page', 'next', 'limit', 'skip'],
                        jump:function (obj,first) {
                            if(!first){
                                channelSearch(name, status);
                            }
                        }
                    })
                }
            })

            //监听工具条
            table.on('tool(test)', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
                var data = obj.data //获得当前行数据
                    ,layEvent = obj.event; //获得 lay-event 对应的值
                if(layEvent === 'detail'){
                    viewLableInfo(data.attrId);
                    layer.msg(data.attrId);
                } else if(layEvent === 'del'){
                    layer.msg('删除');
                } else if(layEvent === 'edit'){
                    layer.msg('编辑操作');
                }
            });
            //常规用法
            laydate.render({
                elem: '#createDate'
            });
            //常规用法
            laydate.render({
                elem: '#processingTime'
            });

        });
    }
    var name = $('#name').val();
    var status = $('#status').val();
    channelSearch(name, status);

</script>
</body>
</html>